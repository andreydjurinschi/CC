### Лабораторная работа №6. Балансирование нагрузки в облаке и авто-масштабирование

_______________________

##### недавно удалось восстановить доступ к AWS аккаунта

_______________________

### Цели

### [LINK](https://github.com/MSU-Courses/cloud-computing/tree/main/_lab/06_Cloud_Load_Balancer_And_AutoScalig)

_______________________

### Шаг 1. Создание VPC и подсетей

![](https://i.imgur.com/iC1WS0f.png)

#### -- подсети готовы --

![](https://i.imgur.com/3oUbId3.png)


#### -- маршруты к публичным подсетям --

![](https://i.imgur.com/sYBC3lY.png)

_______________________

### Шаг 2. Создание и настройка виртуальной машины

далее в созданой VPC необходимо запустить и создать ВМ 

#### -- базовая настройка --

###### ОС + AMI

![](https://i.imgur.com/bK3zxH7.png)


###### VPC + rules

![](https://i.imgur.com/bjyruQk.png)

###### keypair

![](https://i.imgur.com/guy4Q5I.png)

###### сборка доп метрик

![](https://i.imgur.com/a0Z7X5k.png)

###### скрипт `User Data`

```bash
#!/bin/bash

yum update -y
amazon-linux-extras install nginx1 -y
systemctl enable nginx
systemctl start nginx
echo "<h2>GitHub page not found</h2>" > /usr/share/nginx/html/index.html
```

![](https://i.imgur.com/D5jvwYY.png)

![](https://i.imgur.com/dr0ctDL.png)


![](https://i.imgur.com/V1xojjU.png)


###### в последствии мне пришлось пересоздать инстанс, тк 7не заметив, я его создал в приватнолй под сети

![](https://i.imgur.com/66dMYKp.png) 


**скрипт в целях работы не был найцден**

_______________________

### Шаг 3. Создание AMI


![](https://i.imgur.com/XGAzMr5.png)

> Что такое image и чем он отличается от snapshot? Какие есть варианты использования AMI?

AMI — это шаблон виртуальной машины в AWS, который содержит операционную систему, настройки, установленное ПО и данные, необходимые для запуска EC2-инстанса. Его используют для создания новых инстансов с заранее настроенной конфигурацией. Snapshot — это копия диска (EBS volume) в конкретный момент времени, которая нужна для резервного копирования и восстановления данных. Основное отличие в том, что AMI предназначена для запуска инстансов, а snapshot хранит только данные диска и напрямую не запускается как инстанс.

### Шаг 4. Создание Launch Template


###### создаем шаблон создания по требованиям лабораторной работы

![](https://i.imgur.com/HIvT0xU.png)

###### создав новкую версию шаблона устанавливаем Detailed CloudWatch monitoring на enable, для сбора доп метрик autoscalling

![](https://i.imgur.com/i5lE1lD.png)

> Что такое Launch Template и зачем он нужен? Чем он отличается от Launch Configuration?

Launch Template в AWS — это набор заранее определённых параметров для запуска EC2-инстансов, таких как тип инстанса, AMI, ключи, Security Groups, теги и другие настройки. Он нужен, чтобы быстро и последовательно создавать новые инстансы с одинаковой конфигурацией, особенно при использовании Auto Scaling или автоматизации запуска.
Launch Template отличается от Launch Configuration тем, что он более гибкий: поддерживает несколько версий, позволяет задавать больше параметров (например, network interfaces, IAM роли, пользовательские данные), и его можно использовать повторно с обновлением конфигурации без создания новой сущности. Launch Configuration же статичен — после создания изменить его нельзя, и для новой конфигурации нужно создавать новый Launch Configuration.


### Шаг 5. Создание Target 

на основе требований к лабораторной работе создаю `target group` 

![](https://i.imgur.com/LLvgdUX.png)



> Зачем необходим и какую роль выполняет Target Group?

Target Group в AWS используется вместе с Elastic Load Balancer (ELB) для маршрутизации трафика. Она выполняет роль группы целей, куда направляются запросы — это могут быть EC2-инстансы, IP-адреса или Lambda-функции.

Главная роль Target Group — определить, куда именно ELB будет отправлять входящие запросы, и каким образом проверять доступность этих целей через health checks. Это позволяет балансировать нагрузку, исключать недоступные инстансы и обеспечивать стабильную работу приложений.

### Шаг 6. Создание Application Load Balancer

задаем имя, публичные подсети, схему (Internet facing). security группу

> В чем разница между Internet-facing и Internal?

Разница между Internet-facing и Internal в контексте AWS Elastic Load Balancer (ELB) заключается в том, кто может обращаться к балансировщику.
Internet-facing ELB имеет публичный IP и доступен из интернета. Его используют для приложений, к которым должны иметь доступ пользователи извне.
Internal ELB доступен только внутри VPC, через приватные IP. Его используют для внутреннего распределения трафика между сервисами или микросервисами, которые не должны быть видны из интернета.

![](https://i.imgur.com/R4RjriY.png)

![](https://i.imgur.com/OjQu3Li.png)

> Что такое Default action и какие есть типы Default action?

Default action в AWS Elastic Load Balancer — это действие, которое выполняется, если входящий запрос не совпадает ни с одним правилом listener. Проще говоря, это поведение по умолчанию для всего трафика, который не попал под конкретные условия маршрутизации.

___

Forward — пересылка запроса в одну или несколько Target Group
Redirect — перенаправление запроса на другой URL или протокол (например, HTTP → HTTPS).
Return fixed response — возврат заранее определённого ответа клиенту (например, код 404 или сообщение “Service unavailable”).

![](https://i.imgur.com/Y6bFbYd.png)


### Шаг 7. Создание Auto Scaling Group

![](https://i.imgur.com/EBTR6Hk.png)

> Почему для Auto Scaling Group выбираются приватные подсети?

Auto Scaling Group часто размещают в приватных подсетях, чтобы инстансы не были напрямую доступны из интернета**. Это повышает безопасность, потому что серверы приложений или баз данных находятся за NAT или Load Balancer и не имеют публичного IP.

Доступ к ним осуществляется через Load Balancer, что позволяет контролировать входящий трафик и защитить внутренние сервисы от прямых атак извне, при этом сохраняя возможность масштабирования и обновления нагрузки автоматически.


> Зачем нужна настройка: Availability Zone distribution?

Настройка Availability Zone distribution в AWS используется для того, чтобы распределять ресурсы (например, EC2-инстансы или трафик через Load Balancer) равномерно между несколькими зонами доступности (AZ) в регионе.
Это нужно для обеспечения отказоустойчивости и высокой доступности: если одна зона выйдет из строя, остальные смогут продолжать работу, и приложение не перестанет обслуживать пользователей. Также равномерное распределение помогает балансировать нагрузку и улучшает производительность.

###### выбираем две приватные подсети

![](https://i.imgur.com/EBTR6Hk.png)

###### привяязываем к load balancer-y

![](https://i.imgur.com/e0KBqzZ.png)

###### конфигурация size и scalling

![](https://i.imgur.com/mQ2eKjF.png)

> Что такое Instance warm-up period и зачем он нужен?

Instance warm-up period в AWS Auto Scaling — это время, которое даётся новому инстансу после запуска, чтобы он полностью поднялся и стал готов обрабатывать трафик.
Его используют для того, чтобы Auto Scaling не учитывал этот инстанс сразу при расчёте нагрузки, иначе система могла бы ошибочно запускать слишком много новых инстансов, думая, что текущие перегружены. Таким образом warm-up period помогает избежать избыточного масштабирования и экономить ресурсы.

![](https://i.imgur.com/D6xfWsa.png)

### Шаг 8. Тестирование Application Load Balancer

> Какие IP-адреса вы видите и почему?

Видны приватные IP-адреса инстансов из приватных подсетей. Load Balancer распределяет запросы между разными инстансами, поэтому при обновлении страницы IP-адреса меняются — это демонстрирует работу балансировки нагрузки.

###  Тестирование Auto Scaling

![](https://i.imgur.com/AHwcuyp.png)


автоматически создались alarm-ы

![](https://i.imgur.com/VfIRE5z.png)

> Какую роль в этом процессе сыграл Auto Scaling?

Auto Scaling автоматически обнаружил повышенную нагрузку на CPU (выше 50%) и запустил дополнительные инстансы для распределения нагрузки. Это обеспечило масштабирование приложения без ручного вмешательства и поддержание производительности системы.

![](https://i.imgur.com/emnqZoj.png)

### Шаг 10. Завершение работы и очистка ресурсов

все ресурсы были пошагово удалены


